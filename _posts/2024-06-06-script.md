---
title: Creacion del Script
author: mgrl39
date: 2024-06-06
category: Jekyll
layout: post
---
1. Seguimos en el usuario root pero nos encontramos en el directorio de nuestro usuario. Podemos ver la ruta donde nos encontramos con el comando `pwd`. Por lo tanto, nos movemos a la carpeta de root donde ahi guardaremos nuestro script. Siendo el usuario root, podemos ir con `cd`. Estando en `/root` podemos crear ya el script. Se llamara **monitoring.sh**. Modificare el archivo usando `vim` pero realmente podeis utilizar el editor de texto que prefirais.

```bash
vim monitoring.sh
```

![Imagen 189](https://raw.githubusercontent.com/mgrl39/Born2BeRoot/main/steps/b2br_img_189.png)  


2. Escribimos el siguiente contenido del script (no se puede copiar directamente a la maquina virtual, por eso nos hemos conectado por SSH previamente).
Podemos copiar el contenido [AQUI](https://raw.githubusercontent.com/mgrl39/Born2BeRoot/main/monitoring.sh)

![Imagen 190](https://raw.githubusercontent.com/mgrl39/Born2BeRoot/main/steps/b2br_img_190.png)  

3. Salimos del monitoring.sh y ejecutamos `sh monitoring.sh`
```bash
sh monitoring.sh
```
![Imagen 191](https://raw.githubusercontent.com/mgrl39/Born2BeRoot/main/steps/b2br_img_191.png)  
4. Seguidamente, usamos este comando (no hay que preocuparse por la ruta)
```bash
sudo crontab -u root -e
```
![Imagen 193](https://raw.githubusercontent.com/mgrl39/Born2BeRoot/main/steps/b2br_img_193.png)  
5. Es posible que os pregunte que editor quereis utilizar, eso ya es UP TO YOU! (yo seleccione nano).
![Imagen 192](https://raw.githubusercontent.com/mgrl39/Born2BeRoot/main/steps/b2br_img_192.png) 
6. En el fichero debemos añadir el siguiente comando para que el script se ejecute cada 10 minutos `*/10 * * * * sh /ruta del script`.
Es decir:
```bash
*/10 * * * * sh /root/monitoring.sh
```

Este es el significado de cada parametro:

| Parámetro | Descripción        |
|-----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **m**     | Corresponde al minuto en que se va a ejecutar el script, el valor va de 0 a 59.                                                                                               |
| **h**     | La hora exacta, se maneja el formato de 24 horas, los valores van de 0 a 23, siendo 0 las 12:00 de la medianoche.                                                             |
| **dom**   | Hace referencia al día del mes, por ejemplo, se puede especificar 15 si se quiere ejecutar cada día 15.                                                                       |
| **dow**   | Significa el día de la semana, puede ser numérico (0 a 7, donde 0 y 7 son domingo) o las 3 primeras letras del día en inglés: mon, tue, wed, thu, fri, sat, sun.               |
| **user**  | Define el usuario que va a ejecutar el comando, puede ser root, u otro usuario diferente, siempre y cuando tenga permisos de ejecución del script.                            |
| **command** | Refiere al comando o a la ruta absoluta del script a ejecutar.                                                                                                              |

Es decir, en este caso:

| Parámetro  | Valor                | Descripción                                                                |
|------------|----------------------|----------------------------------------------------------------------------|
| **m**      | `*/10`               | El script se ejecutará cada 10 minutos.                                    |
| **h**      | `*`                  | Cualquier hora, el script se ejecuta cada hora.                            |
| **dom**    | `*`                  | Cualquier día del mes, el script se ejecuta todos los días del mes.        |
| **dow**    | `*`                  | Cualquier día de la semana, el script se ejecuta todos los días de la semana.|
| **user**   | *No especificado*    | No se define un usuario específico, se usará el usuario predeterminado del entorno. |
| **command**| `sh /root/monitoring.sh` | Comando para ejecutar el script ubicado en `/root/monitoring.sh`.         |


![Imagen 194](https://raw.githubusercontent.com/mgrl39/Born2BeRoot/main/steps/b2br_img_194.png)  

```bash
crontab -l
```

![Imagen 195](https://raw.githubusercontent.com/mgrl39/Born2BeRoot/main/steps/b2br_img_195.png)  
